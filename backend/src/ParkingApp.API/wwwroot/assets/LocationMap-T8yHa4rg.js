import{r as u,j as e}from"./index-BD1vJQCf.js";import{c as w,l as N,a as y,M as x,T as j,b as g,L as d,u as b}from"./leaflet-BHpfzUxG.js";const v=w(function(r,o){const s=new N.Popup(r,o.overlayContainer);return y(s,o)},function(r,o,{position:s},l){u.useEffect(function(){const{instance:n}=r;function h(t){t.popup===n&&(n.update(),l(!0))}function a(t){t.popup===n&&l(!1)}return o.map.on({popupopen:h,popupclose:a}),o.overlayContainer==null?(s!=null&&n.setLatLng(s),n.openOn(o.map)):o.overlayContainer.bindPopup(n),function(){o.map.off({popupopen:h,popupclose:a}),o.overlayContainer?.unbindPopup(),o.map.removeLayer(n)}},[r,o,l,s])});delete d.Icon.Default.prototype._getIconUrl;d.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});const P=new d.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-40],shadowSize:[41,41]}),F=["Open","Covered","Garage","Street","Underground"];function L({spaces:p}){const r=b();return u.useEffect(()=>{if(p.length>0){const o=d.latLngBounds(p.map(s=>[parseFloat(s.latitude),parseFloat(s.longitude)]));r.fitBounds(o,{padding:[40,40],maxZoom:15})}},[p,r]),null}function E({parkingSpaces:p=[],singleLocation:r=null,height:o="400px",highlightedId:s=null,onMarkerHover:l=null}){const m=u.useRef({});if(u.useEffect(()=>{s&&m.current[s]&&m.current[s].openPopup()},[s]),r){const{latitude:a,longitude:t,title:f}=r,i=parseFloat(a),c=parseFloat(t);return isNaN(i)||isNaN(c)||i===0&&c===0?e.jsxs("div",{className:"map-unavailable",children:[e.jsx("span",{children:"ğŸ“"}),e.jsx("p",{children:"Location not available on map"})]}):e.jsx("div",{className:"map-container",style:{height:o,borderRadius:"var(--radius-md)",overflow:"hidden"},children:e.jsxs(x,{center:[i,c],zoom:16,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[e.jsx(j,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(g,{position:[i,c],children:e.jsx(v,{children:e.jsxs("div",{className:"map-popup",children:[e.jsx("strong",{children:f||"Parking Location"}),e.jsx("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${i},${c}`,target:"_blank",rel:"noopener noreferrer",className:"map-popup-nav",children:"ğŸ§­ Get Directions"})]})})})]})})}const n=u.useMemo(()=>p.filter(a=>{const t=parseFloat(a.latitude),f=parseFloat(a.longitude);return!isNaN(t)&&!isNaN(f)&&!(t===0&&f===0)}),[p]);if(n.length===0)return e.jsxs("div",{className:"map-unavailable",style:{height:o},children:[e.jsx("span",{children:"ğŸ—ºï¸"}),e.jsx("p",{children:"Search for parking to see locations on the map"})]});const h=[20.5937,78.9629];return e.jsx("div",{className:"map-container",style:{height:o,borderRadius:"var(--radius-md)",overflow:"hidden"},children:e.jsxs(x,{center:h,zoom:5,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[e.jsx(j,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(L,{spaces:n}),n.map(a=>e.jsx(g,{position:[parseFloat(a.latitude),parseFloat(a.longitude)],icon:a.id===s?P:new d.Icon.Default,ref:t=>{t&&(m.current[a.id]=t)},eventHandlers:{mouseover:()=>l?.(a.id),mouseout:()=>l?.(null)},children:e.jsx(v,{children:e.jsxs("div",{className:"map-popup",children:[e.jsx("strong",{children:a.title}),e.jsxs("p",{className:"map-popup-address",children:["ğŸ“ ",a.address,", ",a.city]}),e.jsxs("div",{className:"map-popup-details",children:[e.jsxs("span",{children:["â‚¹",a.hourlyRate,"/hr"]}),e.jsxs("span",{children:["â­ ",a.averageRating?.toFixed(1)||"New"]}),e.jsx("span",{children:F[a.parkingType]||"Open"})]}),e.jsxs("div",{className:"map-popup-actions",children:[e.jsx("a",{href:`/parking/${a.id}`,className:"map-popup-link",children:"View Details â†’"}),e.jsx("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${parseFloat(a.latitude)},${parseFloat(a.longitude)}`,target:"_blank",rel:"noopener noreferrer",className:"map-popup-nav",children:"ğŸ§­ Navigate"})]})]})})},a.id))]})})}export{E as L};
